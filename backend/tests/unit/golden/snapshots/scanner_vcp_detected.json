{
  "score": 72.430769,
  "passes": false,
  "rating": "Watch",
  "breakdown": {
    "quality_score": 75.0,
    "readiness_score": 68.576923,
    "setup_score": 72.430769
  },
  "screener_name": "setup_engine",
  "setup_engine": {
    "schema_version": "v1",
    "timeframe": "daily",
    "setup_score": 72.430769,
    "quality_score": 75.0,
    "readiness_score": 68.576923,
    "setup_ready": false,
    "pattern_primary": "vcp",
    "pattern_confidence": 78.644,
    "pivot_price": 132.25,
    "pivot_type": "vcp_pivot",
    "pivot_date": null,
    "distance_to_pivot_pct": -1.7013232514177694,
    "in_early_zone": true,
    "extended_from_pivot": false,
    "base_length_weeks": null,
    "base_depth_pct": 1.2,
    "support_tests_count": null,
    "tight_closes_count": null,
    "atr14_pct": 1.97134670487123,
    "atr14_pct_trend": 3.225147177677364e-05,
    "bb_width_pct": 2.568785520576754,
    "bb_width_pctile_252": 0.3968253968253968,
    "bb_squeeze": true,
    "volume_vs_50d": 1.0,
    "up_down_volume_ratio_10d": 1e+16,
    "quiet_days_10d": 0,
    "rs": 0.24528301886792453,
    "rs_line_new_high": true,
    "rs_vs_spy_65d": 2.795248078266943,
    "rs_vs_spy_trend_20d": 9.924893188794194e-05,
    "stage": 2,
    "ma_alignment_score": 100.0,
    "rs_rating": 57.93,
    "candidates": [
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 131.3,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-16",
        "start_date": "2023-05-12",
        "end_date": "2023-06-16",
        "distance_to_pivot_pct": 1.0000000000000087,
        "setup_score": 71.141752,
        "quality_score": 74.063918,
        "readiness_score": 65.60882,
        "confidence": 0.744351,
        "confidence_pct": 74.4351,
        "metrics": {
          "run_rank": 1,
          "weeks_tight": 6,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.396804,
          "tight_range_pct": 5.236116,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-12",
          "run_end_date": "2023-06-16",
          "median_close": 128.209169,
          "recency_weeks": 0,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 82.031959,
          "raw_readiness_score": 79.523969,
          "raw_confidence": 0.81688,
          "raw_confidence_pct": 81.687973,
          "normalized_quality_score_0_1": 0.740639,
          "normalized_readiness_score_0_1": 0.656088,
          "normalized_confidence_0_1": 0.778133,
          "calibrated_quality_score": 74.063918,
          "calibrated_readiness_score": 65.60882,
          "calibrated_confidence": 0.744351,
          "calibrated_confidence_pct": 74.4351,
          "aggregation_rank_score": 0.72577,
          "candidate_setup_score": 71.141752,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 130.57650429799426,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-09",
        "start_date": "2023-05-05",
        "end_date": "2023-06-09",
        "distance_to_pivot_pct": 0.44346484461097085,
        "setup_score": 68.942748,
        "quality_score": 73.906956,
        "readiness_score": 59.922463,
        "confidence": 0.732106,
        "confidence_pct": 73.2106,
        "metrics": {
          "run_rank": 2,
          "weeks_tight": 6,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.404652,
          "tight_range_pct": 5.254298,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-05",
          "run_end_date": "2023-06-09",
          "median_close": 127.492837,
          "recency_weeks": 1,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 81.953478,
          "raw_readiness_score": 76.965108,
          "raw_confidence": 0.816357,
          "raw_confidence_pct": 81.635652,
          "normalized_quality_score_0_1": 0.73907,
          "normalized_readiness_score_0_1": 0.599225,
          "normalized_confidence_0_1": 0.777261,
          "calibrated_quality_score": 73.906956,
          "calibrated_readiness_score": 59.922463,
          "calibrated_confidence": 0.732106,
          "calibrated_confidence_pct": 73.2106,
          "aggregation_rank_score": 0.707271,
          "candidate_setup_score": 68.942748,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 129.85300859598854,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-02",
        "start_date": "2023-04-28",
        "end_date": "2023-06-02",
        "distance_to_pivot_pct": -0.11307031077804526,
        "setup_score": 66.742121,
        "quality_score": 73.74822,
        "readiness_score": 54.234628,
        "confidence": 0.719848,
        "confidence_pct": 71.9848,
        "metrics": {
          "run_rank": 3,
          "weeks_tight": 6,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.412589,
          "tight_range_pct": 5.272686,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-04-28",
          "run_end_date": "2023-06-02",
          "median_close": 126.776504,
          "recency_weeks": 2,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 81.87411,
          "raw_readiness_score": 74.405583,
          "raw_confidence": 0.815827,
          "raw_confidence_pct": 81.58274,
          "normalized_quality_score_0_1": 0.737482,
          "normalized_readiness_score_0_1": 0.542346,
          "normalized_confidence_0_1": 0.776379,
          "calibrated_quality_score": 73.74822,
          "calibrated_readiness_score": 54.234628,
          "calibrated_confidence": 0.719848,
          "calibrated_confidence_pct": 71.9848,
          "aggregation_rank_score": 0.688756,
          "candidate_setup_score": 66.742121,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 131.3,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-16",
        "start_date": "2023-05-19",
        "end_date": "2023-06-16",
        "distance_to_pivot_pct": 1.0000000000000087,
        "setup_score": 68.854738,
        "quality_score": 67.713394,
        "readiness_score": 70.316717,
        "confidence": 0.700152,
        "confidence_pct": 70.0152,
        "metrics": {
          "run_rank": 4,
          "weeks_tight": 5,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.11433,
          "tight_range_pct": 4.669935,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-19",
          "run_end_date": "2023-06-16",
          "median_close": 128.567335,
          "recency_weeks": 0,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 78.856697,
          "raw_readiness_score": 81.642523,
          "raw_confidence": 0.775711,
          "raw_confidence_pct": 77.571131,
          "normalized_quality_score_0_1": 0.677134,
          "normalized_readiness_score_0_1": 0.703167,
          "normalized_confidence_0_1": 0.709519,
          "calibrated_quality_score": 67.713394,
          "calibrated_readiness_score": 70.316717,
          "calibrated_confidence": 0.700152,
          "calibrated_confidence_pct": 70.0152,
          "aggregation_rank_score": 0.695001,
          "candidate_setup_score": 68.854738,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 129.12951289398282,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-05-26",
        "start_date": "2023-04-21",
        "end_date": "2023-05-26",
        "distance_to_pivot_pct": -0.6696054661670613,
        "setup_score": 64.539855,
        "quality_score": 73.58768,
        "readiness_score": 48.545289,
        "confidence": 0.707578,
        "confidence_pct": 70.7578,
        "metrics": {
          "run_rank": 5,
          "weeks_tight": 6,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.420616,
          "tight_range_pct": 5.291283,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-04-21",
          "run_end_date": "2023-05-26",
          "median_close": 126.060172,
          "recency_weeks": 3,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 81.79384,
          "raw_readiness_score": 71.84538,
          "raw_confidence": 0.815292,
          "raw_confidence_pct": 81.529227,
          "normalized_quality_score_0_1": 0.735877,
          "normalized_readiness_score_0_1": 0.485453,
          "normalized_confidence_0_1": 0.775487,
          "calibrated_quality_score": 73.58768,
          "calibrated_readiness_score": 48.545289,
          "calibrated_confidence": 0.707578,
          "calibrated_confidence_pct": 70.7578,
          "aggregation_rank_score": 0.670228,
          "candidate_setup_score": 64.539855,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "first_pullback",
        "timeframe": "daily",
        "source_detector": "first_pullback",
        "pivot_price": 130.7212034383954,
        "pivot_type": "resumption_high",
        "pivot_date": "2023-06-12",
        "start_date": "2023-06-09",
        "end_date": "2023-06-12",
        "distance_to_pivot_pct": null,
        "setup_score": 6.983105,
        "quality_score": 8.462063,
        "readiness_score": 0.0,
        "confidence": 0.232897,
        "confidence_pct": 23.2897,
        "metrics": {
          "ma_period_bars": 21,
          "ma_touch_band_pct": 1.5,
          "touch_separation_bars": 5,
          "tests_count": 55,
          "is_first_test": false,
          "is_second_test": false,
          "latest_test_close": 129.2837,
          "latest_test_low": 127.9908,
          "latest_test_ma": 127.851,
          "ma_touch_distance_pct": 0.1094,
          "pullback_span_bars": 325,
          "pullback_high_price": 130.5765,
          "pullback_high_date": "2023-06-09",
          "pullback_span_low": 82.0367,
          "pullback_depth_points": 48.5398,
          "pullback_depth_pct_from_high": 37.173478,
          "resumption_high_price": 130.7212,
          "resumption_high_date": "2023-06-12",
          "resumption_close": 129.4269,
          "resumption_ema10": 128.7822,
          "resumption_volume_ratio_20d": 1.0,
          "resumption_trigger_offset_bars": 1,
          "pivot_mode_chosen": "resumption_high",
          "pivot_mode_alternate": "pullback_high",
          "pivot_choice_reason": "resumption_trigger_confirmed",
          "pullback_orderliness_score": 0.366541,
          "pullback_avg_range_pct": 2.0,
          "pullback_close_volatility_pct": 0.001253,
          "pullback_lower_high_ratio": 0.0,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "first_pullback",
          "raw_quality_score": 44.654134,
          "raw_readiness_score": 0.0,
          "raw_confidence": 0.544944,
          "raw_confidence_pct": 54.49436,
          "normalized_quality_score_0_1": 0.084621,
          "normalized_readiness_score_0_1": 0.0,
          "normalized_confidence_0_1": 0.421348,
          "calibrated_quality_score": 8.462063,
          "calibrated_readiness_score": 0.0,
          "calibrated_confidence": 0.232897,
          "calibrated_confidence_pct": 23.2897,
          "aggregation_rank_score": 0.149249,
          "candidate_setup_score": 6.983105,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "ma_touch_detected": true,
          "ma_touch_within_band": true,
          "is_first_test": false,
          "is_second_test": false,
          "pullback_depth_positive": true,
          "pullback_orderly": false,
          "resumption_trigger_confirmed": true,
          "resumption_price_reclaimed_ema10": true,
          "resumption_volume_supportive": true,
          "pivot_mode_pullback_high": false,
          "pivot_mode_resumption_high": true
        },
        "notes": [
          "ma_touch_test_counting_complete",
          "resumption_trigger_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "vcp",
        "timeframe": "daily",
        "source_detector": "vcp",
        "pivot_price": 132.25,
        "pivot_type": "vcp_pivot",
        "pivot_date": null,
        "start_date": null,
        "end_date": null,
        "distance_to_pivot_pct": 1.7307692307692308,
        "setup_score": 73.116323,
        "quality_score": 75.0,
        "readiness_score": 68.576923,
        "confidence": 0.78644,
        "confidence_pct": 78.644,
        "metrics": {
          "num_bases": 4,
          "vcp_score": 82.5,
          "contraction_ratio": 0.62,
          "depth_score": 88.0,
          "volume_score": 74.0,
          "tightness_score": 90.0,
          "atr_score": 71.0,
          "atr_contraction_ratio": 0.68,
          "distance_from_high_pct": 1.2,
          "distance_to_pivot_pct_legacy": 1.8,
          "ready_for_breakout": true,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "vcp",
          "raw_quality_score": 82.5,
          "raw_readiness_score": 79.288462,
          "raw_confidence": 0.825,
          "raw_confidence_pct": 82.5,
          "normalized_quality_score_0_1": 0.75,
          "normalized_readiness_score_0_1": 0.685769,
          "normalized_confidence_0_1": 0.821429,
          "calibrated_quality_score": 75.0,
          "calibrated_readiness_score": 68.576923,
          "calibrated_confidence": 0.78644,
          "calibrated_confidence_pct": 78.644,
          "aggregation_rank_score": 0.757196,
          "candidate_setup_score": 73.116323,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "vcp_detected_by_legacy": true,
          "contracting_depth": true,
          "contracting_volume": true,
          "tight_near_highs": true,
          "pivot_available": true
        },
        "notes": [
          "legacy_vcp_wrapper_no_logic_fork",
          "cross_detector_calibration_v1_applied"
        ]
      }
    ],
    "explain": {
      "passed_checks": [
        "detected",
        "tight_run_detected",
        "ma_tests_identified",
        "legacy_vcp_detection_passed",
        "cross_detector_calibration_applied",
        "detector_pipeline_executed",
        "primary_pattern_selected",
        "setup_score_ok",
        "quality_floor_ok",
        "in_early_zone",
        "atr14_within_limit",
        "rs_leadership_ok",
        "stage_ok",
        "ma_alignment_ok",
        "rs_rating_ok"
      ],
      "failed_checks": [
        "not_detected",
        "cup_structure_not_found",
        "pole_return_below_threshold",
        "nr7_inside_day_trigger_not_found",
        "not_implemented",
        "readiness_below_threshold",
        "volume_below_minimum"
      ],
      "key_levels": {
        "pivot_price": 132.25
      },
      "invalidation_flags": []
    }
  }
}
