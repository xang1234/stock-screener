{
  "score": 89.565217,
  "passes": false,
  "rating": "Watch",
  "breakdown": {
    "quality_score": 100.0,
    "readiness_score": 73.913043,
    "setup_score": 89.565217
  },
  "screener_name": "setup_engine",
  "setup_engine": {
    "schema_version": "v1",
    "timeframe": "daily",
    "setup_score": 89.565217,
    "quality_score": 100.0,
    "readiness_score": 73.913043,
    "setup_ready": false,
    "pattern_primary": "nr7_inside_day",
    "pattern_confidence": 78.7676,
    "pivot_price": 120.15,
    "pivot_type": "nr7_inside_day_trigger_high",
    "pivot_date": "2023-06-16",
    "distance_to_pivot_pct": -0.1248439450686689,
    "in_early_zone": true,
    "extended_from_pivot": false,
    "base_length_weeks": null,
    "base_depth_pct": null,
    "support_tests_count": null,
    "tight_closes_count": null,
    "atr14_pct": 2.8043081703870594,
    "atr14_pct_trend": -0.012458981763172255,
    "bb_width_pct": 3.3500544936910432,
    "bb_width_pctile_252": 0.3968253968253968,
    "bb_squeeze": true,
    "volume_vs_50d": 1.0,
    "up_down_volume_ratio_10d": 1e+16,
    "quiet_days_10d": 0,
    "rs": 0.22641509433962265,
    "rs_line_new_high": true,
    "rs_vs_spy_65d": 5.2311544308325075,
    "rs_vs_spy_trend_20d": 0.00016748257256090336,
    "stage": 2,
    "ma_alignment_score": 100.0,
    "rs_rating": 65.79,
    "candidates": [
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 122.82808022922636,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-16",
        "start_date": "2023-05-19",
        "end_date": "2023-06-16",
        "distance_to_pivot_pct": 2.356733524355299,
        "setup_score": 62.655687,
        "quality_score": 60.930233,
        "readiness_score": 64.664083,
        "confidence": 0.651163,
        "confidence_pct": 65.11630000000001,
        "metrics": {
          "run_rank": 1,
          "weeks_tight": 5,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.453488,
          "tight_range_pct": 7.348837,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-19",
          "run_end_date": "2023-06-16",
          "median_close": 118.280802,
          "recency_weeks": 0,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 75.465116,
          "raw_readiness_score": 79.098837,
          "raw_confidence": 0.753101,
          "raw_confidence_pct": 75.310078,
          "normalized_quality_score_0_1": 0.609302,
          "normalized_readiness_score_0_1": 0.646641,
          "normalized_confidence_0_1": 0.671835,
          "calibrated_quality_score": 60.930233,
          "calibrated_readiness_score": 64.664083,
          "calibrated_confidence": 0.651163,
          "calibrated_confidence_pct": 65.1163,
          "aggregation_rank_score": 0.639793,
          "candidate_setup_score": 62.655687,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 120.84040114613181,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-09",
        "start_date": "2023-05-12",
        "end_date": "2023-06-09",
        "distance_to_pivot_pct": 0.7003342884431756,
        "setup_score": 60.405648,
        "quality_score": 60.717423,
        "readiness_score": 58.931186,
        "confidence": 0.638515,
        "confidence_pct": 63.85150000000001,
        "metrics": {
          "run_rank": 2,
          "weeks_tight": 5,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.464129,
          "tight_range_pct": 6.430942,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-12",
          "run_end_date": "2023-06-09",
          "median_close": 117.421203,
          "recency_weeks": 1,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 75.358712,
          "raw_readiness_score": 76.519034,
          "raw_confidence": 0.752391,
          "raw_confidence_pct": 75.239141,
          "normalized_quality_score_0_1": 0.607174,
          "normalized_readiness_score_0_1": 0.589312,
          "normalized_confidence_0_1": 0.670652,
          "calibrated_quality_score": 60.717423,
          "calibrated_readiness_score": 58.931186,
          "calibrated_confidence": 0.638515,
          "calibrated_confidence_pct": 63.8515,
          "aggregation_rank_score": 0.620839,
          "candidate_setup_score": 60.405648,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 122.82808022922636,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-16",
        "start_date": "2023-05-26",
        "end_date": "2023-06-16",
        "distance_to_pivot_pct": 2.356733524355299,
        "setup_score": 61.919459,
        "quality_score": 56.276611,
        "readiness_score": 70.786065,
        "confidence": 0.61922,
        "confidence_pct": 61.922,
        "metrics": {
          "run_rank": 3,
          "weeks_tight": 4,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.086169,
          "tight_range_pct": 6.608979,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-26",
          "run_end_date": "2023-06-16",
          "median_close": 118.710602,
          "recency_weeks": 0,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 73.138306,
          "raw_readiness_score": 81.853729,
          "raw_confidence": 0.717589,
          "raw_confidence_pct": 71.75887,
          "normalized_quality_score_0_1": 0.562766,
          "normalized_readiness_score_0_1": 0.707861,
          "normalized_confidence_0_1": 0.612648,
          "calibrated_quality_score": 56.276611,
          "calibrated_readiness_score": 70.786065,
          "calibrated_confidence": 0.61922,
          "calibrated_confidence_pct": 61.922,
          "aggregation_rank_score": 0.622835,
          "candidate_setup_score": 61.919459,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 120.05501432664755,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-02",
        "start_date": "2023-05-05",
        "end_date": "2023-06-02",
        "distance_to_pivot_pct": 0.045845272206292975,
        "setup_score": 58.152737,
        "quality_score": 60.501475,
        "readiness_score": 53.195674,
        "confidence": 0.625844,
        "confidence_pct": 62.584399999999995,
        "metrics": {
          "run_rank": 4,
          "weeks_tight": 5,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.474926,
          "tight_range_pct": 6.530973,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-05",
          "run_end_date": "2023-06-02",
          "median_close": 116.561605,
          "recency_weeks": 2,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 75.250737,
          "raw_readiness_score": 73.938053,
          "raw_confidence": 0.751672,
          "raw_confidence_pct": 75.167158,
          "normalized_quality_score_0_1": 0.605015,
          "normalized_readiness_score_0_1": 0.531957,
          "normalized_confidence_0_1": 0.669453,
          "calibrated_quality_score": 60.501475,
          "calibrated_readiness_score": 53.195674,
          "calibrated_confidence": 0.625844,
          "calibrated_confidence_pct": 62.5844,
          "aggregation_rank_score": 0.601859,
          "candidate_setup_score": 58.152737,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "three_weeks_tight",
        "timeframe": "weekly",
        "source_detector": "three_weeks_tight",
        "pivot_price": 120.84040114613181,
        "pivot_type": "tight_area_high",
        "pivot_date": "2023-06-09",
        "start_date": "2023-05-19",
        "end_date": "2023-06-09",
        "distance_to_pivot_pct": 0.7003342884431756,
        "setup_score": 59.719103,
        "quality_score": 56.118162,
        "readiness_score": 65.098468,
        "confidence": 0.606965,
        "confidence_pct": 60.6965,
        "metrics": {
          "run_rank": 5,
          "weeks_tight": 4,
          "tight_mode": "relaxed",
          "tight_mode_threshold_pct": 1.5,
          "tight_band_pct": 1.094092,
          "tight_range_pct": 5.689035,
          "vol_vs_10w": 1.0,
          "run_start_date": "2023-05-19",
          "run_end_date": "2023-06-09",
          "median_close": 117.851003,
          "recency_weeks": 1,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "three_weeks_tight",
          "raw_quality_score": 73.059081,
          "raw_readiness_score": 79.294311,
          "raw_confidence": 0.717061,
          "raw_confidence_pct": 71.706054,
          "normalized_quality_score_0_1": 0.561182,
          "normalized_readiness_score_0_1": 0.650985,
          "normalized_confidence_0_1": 0.611768,
          "calibrated_quality_score": 56.118162,
          "calibrated_readiness_score": 65.098468,
          "calibrated_confidence": 0.606965,
          "calibrated_confidence_pct": 60.6965,
          "aggregation_rank_score": 0.604323,
          "candidate_setup_score": 59.719103,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "weeks_tight_min_met": true,
          "tight_band_ok": true,
          "tight_mode_strict": false,
          "tight_mode_relaxed": true
        },
        "notes": [
          "strict_relaxed_modes_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "first_pullback",
        "timeframe": "daily",
        "source_detector": "first_pullback",
        "pivot_price": 121.31232091690543,
        "pivot_type": "resumption_high",
        "pivot_date": "2023-06-12",
        "start_date": "2023-06-09",
        "end_date": "2023-06-12",
        "distance_to_pivot_pct": null,
        "setup_score": 4.957942,
        "quality_score": 5.055258,
        "readiness_score": 0.0,
        "confidence": 0.217755,
        "confidence_pct": 21.7755,
        "metrics": {
          "ma_period_bars": 21,
          "ma_touch_band_pct": 1.5,
          "touch_separation_bars": 5,
          "tests_count": 55,
          "is_first_test": false,
          "is_second_test": false,
          "latest_test_close": 119.1404,
          "latest_test_low": 117.4404,
          "latest_test_ma": 117.4212,
          "ma_touch_distance_pct": 0.0163,
          "pullback_span_bars": 325,
          "pullback_high_price": 120.8404,
          "pullback_high_date": "2023-06-09",
          "pullback_span_low": 62.4868,
          "pullback_depth_points": 58.3536,
          "pullback_depth_pct_from_high": 48.289795,
          "resumption_high_price": 121.3123,
          "resumption_high_date": "2023-06-12",
          "resumption_close": 119.3123,
          "resumption_ema10": 118.5387,
          "resumption_volume_ratio_20d": 1.0,
          "resumption_trigger_offset_bars": 1,
          "pivot_mode_chosen": "resumption_high",
          "pivot_mode_alternate": "pullback_high",
          "pivot_choice_reason": "resumption_trigger_confirmed",
          "pullback_orderliness_score": 0.347804,
          "pullback_avg_range_pct": 2.835779,
          "pullback_close_volatility_pct": 0.002151,
          "pullback_lower_high_ratio": 0.029412,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "first_pullback",
          "raw_quality_score": 42.780392,
          "raw_readiness_score": 0.0,
          "raw_confidence": 0.536512,
          "raw_confidence_pct": 53.651176,
          "normalized_quality_score_0_1": 0.050553,
          "normalized_readiness_score_0_1": 0.0,
          "normalized_confidence_0_1": 0.409303,
          "calibrated_quality_score": 5.055258,
          "calibrated_readiness_score": 0.0,
          "calibrated_confidence": 0.217755,
          "calibrated_confidence_pct": 21.7755,
          "aggregation_rank_score": 0.132403,
          "candidate_setup_score": 4.957942,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "ma_touch_detected": true,
          "ma_touch_within_band": true,
          "is_first_test": false,
          "is_second_test": false,
          "pullback_depth_positive": true,
          "pullback_orderly": false,
          "resumption_trigger_confirmed": true,
          "resumption_price_reclaimed_ema10": true,
          "resumption_volume_supportive": true,
          "pivot_mode_pullback_high": false,
          "pivot_mode_resumption_high": true
        },
        "notes": [
          "ma_touch_test_counting_complete",
          "resumption_trigger_evaluated",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "nr7_inside_day",
        "timeframe": "daily",
        "source_detector": "nr7_inside_day",
        "pivot_price": 120.15,
        "pivot_type": "nr7_inside_day_trigger_high",
        "pivot_date": "2023-06-16",
        "start_date": null,
        "end_date": null,
        "distance_to_pivot_pct": 0.12500000000000472,
        "setup_score": 88.746325,
        "quality_score": 100.0,
        "readiness_score": 73.913043,
        "confidence": 0.787676,
        "confidence_pct": 78.7676,
        "metrics": {
          "trigger_rank": 1,
          "trigger_subtype": "nr7_inside_day",
          "trigger_is_nr7": true,
          "trigger_is_inside_day": true,
          "trigger_high": 120.15,
          "trigger_low": 119.85,
          "trigger_range_points": 0.3,
          "trigger_range_pct": 0.249688,
          "range_min_7d_points": 0.3,
          "range_rank_7d": 1,
          "trigger_volume": 1000000.0,
          "volume_mean_20d": 1000000.0,
          "volume_ratio_20d": 1.0,
          "ema21_trigger": 118.280802,
          "close_above_ema21": true,
          "trigger_recency_bars": 0,
          "trigger_score": 0.862522,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "nr7_inside_day",
          "raw_quality_score": 65.0,
          "raw_readiness_score": 58.0,
          "raw_confidence": 0.674387,
          "raw_confidence_pct": 67.438702,
          "normalized_quality_score_0_1": 1.0,
          "normalized_readiness_score_0_1": 0.73913,
          "normalized_confidence_0_1": 0.817909,
          "calibrated_quality_score": 100.0,
          "calibrated_readiness_score": 73.913043,
          "calibrated_confidence": 0.787676,
          "calibrated_confidence_pct": 78.7676,
          "aggregation_rank_score": 0.831048,
          "candidate_setup_score": 88.746325,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "trigger_detected": true,
          "trigger_is_nr7": true,
          "trigger_is_inside_day": true,
          "trigger_is_combined": true,
          "range_is_7d_min": true,
          "inside_day_structure_valid": true,
          "volume_not_expanded": true,
          "context_close_above_ema21": true
        },
        "notes": [
          "trigger_detector_lightweight_scoring",
          "subtype_nr7_inside_day",
          "cross_detector_calibration_v1_applied"
        ]
      },
      {
        "pattern": "nr7_inside_day",
        "timeframe": "daily",
        "source_detector": "nr7_inside_day",
        "pivot_price": 118.95272206303724,
        "pivot_type": "nr7_inside_day_trigger_high",
        "pivot_date": "2023-06-05",
        "start_date": null,
        "end_date": null,
        "distance_to_pivot_pct": -0.872731614135631,
        "setup_score": 76.020262,
        "quality_score": 92.663156,
        "readiness_score": 52.391304,
        "confidence": 0.671857,
        "confidence_pct": 67.1857,
        "metrics": {
          "trigger_rank": 2,
          "trigger_subtype": "nr7_inside_day",
          "trigger_is_nr7": true,
          "trigger_is_inside_day": true,
          "trigger_high": 118.9527,
          "trigger_low": 117.9527,
          "trigger_range_points": 1.0,
          "trigger_range_pct": 0.84067,
          "range_min_7d_points": 1.0,
          "range_rank_7d": 1,
          "trigger_volume": 1000000.0,
          "volume_mean_20d": 1000000.0,
          "volume_ratio_20d": 1.0,
          "ema21_trigger": 116.733524,
          "close_above_ema21": true,
          "trigger_recency_bars": 9,
          "trigger_score": 0.758153,
          "calibration_version": "cross_detector_v1",
          "calibration_source_detector": "nr7_inside_day",
          "raw_quality_score": 61.69842,
          "raw_readiness_score": 48.1,
          "raw_confidence": 0.616984,
          "raw_confidence_pct": 61.69842,
          "normalized_quality_score_0_1": 0.926632,
          "normalized_readiness_score_0_1": 0.523913,
          "normalized_confidence_0_1": 0.718938,
          "calibrated_quality_score": 92.663156,
          "calibrated_readiness_score": 52.391304,
          "calibrated_confidence": 0.671857,
          "calibrated_confidence_pct": 67.1857,
          "aggregation_rank_score": 0.705962,
          "candidate_setup_score": 76.020262,
          "setup_score_method": "candidate_blend_v1"
        },
        "checks": {
          "trigger_detected": true,
          "trigger_is_nr7": true,
          "trigger_is_inside_day": true,
          "trigger_is_combined": true,
          "range_is_7d_min": true,
          "inside_day_structure_valid": true,
          "volume_not_expanded": true,
          "context_close_above_ema21": true
        },
        "notes": [
          "trigger_detector_lightweight_scoring",
          "subtype_nr7_inside_day",
          "cross_detector_calibration_v1_applied"
        ]
      }
    ],
    "explain": {
      "passed_checks": [
        "detected",
        "tight_run_detected",
        "ma_tests_identified",
        "nr7_inside_day_trigger_found",
        "trigger_subtypes_labeled",
        "cross_detector_calibration_applied",
        "detector_pipeline_executed",
        "primary_pattern_selected",
        "setup_score_ok",
        "quality_floor_ok",
        "readiness_floor_ok",
        "in_early_zone",
        "atr14_within_limit",
        "rs_leadership_ok",
        "stage_ok",
        "ma_alignment_ok",
        "rs_rating_ok"
      ],
      "failed_checks": [
        "not_detected",
        "cup_structure_not_found",
        "pole_return_below_threshold",
        "vcp_contracting_depth_failed",
        "vcp_tight_near_highs_failed",
        "vcp_score_below_legacy_threshold",
        "vcp_insufficient_bases",
        "not_implemented",
        "volume_below_minimum"
      ],
      "key_levels": {
        "pivot_price": 120.15
      },
      "invalidation_flags": []
    }
  }
}
